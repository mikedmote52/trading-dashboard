<!DOCTYPE html>
<html>
<head>
    <title>Simple Portfolio Test</title>
    <style>
        body { background: #0f172a; color: white; font-family: Arial; padding: 20px; }
        .position { border: 1px solid #444; padding: 15px; margin: 10px 0; background: rgba(255,255,255,0.1); border-radius: 8px; }
        .green { color: #10b981; }
        .red { color: #ef4444; }
    </style>
</head>
<body>
    <h1>Portfolio Positions Test</h1>
    <div id="portfolio">Loading...</div>
    
    <script>
        console.log('üöÄ Simple test started');
        
        async function loadPortfolio() {
            try {
                console.log('üìä Fetching /api/dashboard...');
                const response = await fetch('/api/dashboard');
                const data = await response.json();
                
                console.log('‚úÖ API Response received:', {
                    hasPortfolio: !!data.portfolio,
                    positionsCount: data.portfolio?.positions?.length
                });
                
                const positions = data.portfolio?.positions || [];
                const container = document.getElementById('portfolio');
                
                if (positions.length === 0) {
                    container.innerHTML = '<div>No positions found</div>';
                    return;
                }
                
                container.innerHTML = positions.map(pos => `
                    <div class="position">
                        <strong>${pos.symbol}</strong> - ${pos.qty} shares @ $${pos.currentPrice?.toFixed(2)}
                        <br><span class="${pos.unrealizedPnL >= 0 ? 'green' : 'red'}">
                            P&L: $${pos.unrealizedPnL?.toFixed(2)} (${pos.unrealizedPnLPercent?.toFixed(1)}%)
                        </span>
                        <br>Risk: ${pos.riskAnalysis?.recommendation || 'HOLD'}
                    </div>
                `).join('');
                
                console.log('üéâ Portfolio rendered successfully!');
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                document.getElementById('portfolio').innerHTML = `<div style="color: red;">Error: ${error.message}</div>`;
            }
        }
        
        // Load immediately
        loadPortfolio();
    </script>
</body>
</html>